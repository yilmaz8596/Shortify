@model LoginVM;

@{
    ViewData["Title"] = "Login";
    ViewData["HideFooter"] = true;
    ViewData["AuthPage"] = true;
}

@if(TempData["Success"] != null)
{
    <div class="container" style="position: fixed; top: 90px; left: 50%; transform: translateX(-50%); z-index: 1050; max-width: 600px;">    
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["Success"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    </div>
}

<div class="auth-page">
    <div class="auth-card">
        <div class="card shadow-sm">   
            <div class="card-body p-4">
                <h3 class="card-title mb-3 text-center">Welcome back</h3>
                <p class="text-muted text-center mb-3">Sign in to your account to manage your short links</p>

                <!-- Email/Password Login Form -->
                <form asp-controller="Authentication" asp-action="LoginSubmitted" method="post">
                    @Html.AntiForgeryToken()

                    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="text" class="form-control" id="email" name="Email" placeholder="you@example.com" asp-for="Email" />
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>

                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" asp-for="Password" class="form-control" id="password" name="Password" placeholder="Enter your password" required />
                        <span asp-validation-for="Password" class="text-danger"></span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="true" id="remember" name="RememberMe">
                            <label class="form-check-label" for="remember">Remember me</label>
                        </div>
                        <a asp-controller="Authentication" asp-action="ForgotPassword" class="small text-muted">Forgot?</a>
                    </div>

                    <div class="d-grid mb-3">
                        <button class="btn btn-primary-orange btn-lg">Sign in</button>
                    </div>

                    <div class="text-center mb-3">
                        <small class="text-muted">Don't have an account? <a asp-controller="Authentication" asp-action="Register">Register</a></small>
                    </div>
                </form>

                <div class="separator mb-3">
                    <span class="separator-text">OR</span>
                </div>

                <!-- Social Login Buttons -->
                <div class="social-login">
                    <form asp-controller="Authentication" asp-action="ExternalLogin" method="post">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="provider" value="Google" />
                        <input type="hidden" name="returnUrl" value="@ViewData["ReturnUrl"]" />
                        <button type="submit" class="btn btn-outline-secondary w-100 mb-2 d-flex align-items-center justify-content-center py-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 48 48" class="me-2">
                                <path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4 12.955 4 4 12.955 4 24s8.955 20 20 20 20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z"/>
                                <path fill="#FF3D00" d="m6.306 14.691 6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4 16.318 4 9.656 8.337 6.306 14.691z"/>
                                <path fill="#4CAF50" d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238A11.91 11.91 0 0 1 24 36c-5.202 0-9.619-3.317-11.283-7.946l-6.522 5.025C9.505 39.556 16.227 44 24 44z"/>
                                <path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303a12.04 12.04 0 0 1-4.087 5.571l.003-.002 6.19 5.238C36.971 39.205 44 34 44 24c0-1.341-.138-2.65-.389-3.917z"/>
                            </svg>
                            Continue with Google
                        </button>
                    </form>

                    <form asp-controller="Authentication" asp-action="ExternalLogin" method="post">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="provider" value="GitHub" />
                        <input type="hidden" name="returnUrl" value="@ViewData["ReturnUrl"]" />
                        <button type="submit" class="btn btn-dark w-100 d-flex align-items-center justify-content-center py-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="me-2" viewBox="0 0 16 16">
                                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                            </svg>
                            Continue with GitHub
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .auth-page {
            min-height: calc(100vh - 60px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .auth-card {
            width: 100%;
            max-width: 440px;
        }

        .card-body {
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .card-body::-webkit-scrollbar {
            display: none;
        }

        .separator {
            position: relative;
            text-align: center;
            margin:0.2rem 0;
        }
        
        .separator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #dee2e6;
        }
        
        .separator-text {
            position: relative;
            background: white;
            padding: 0 1rem;
            color: #6c757d;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .social-login .btn {
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .social-login .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .social-login .btn-outline-secondary {
            border: 1px solid #dee2e6;
            color: #495057;
        }
        
        .social-login .btn-outline-secondary:hover {
            background-color: #f8f9fa;
            border-color: #dee2e6;
            color: #495057;
        }

        .mb-3 {
            margin-bottom: 0.75rem !important;
        }

        h3.card-title {
            margin-bottom: 0.5rem !important;
        }

        @@media (max-height: 700px) {
            .auth-page {
                padding: 0.5rem;
            }
            
            .card-body {
                padding: 1.5rem !important;
            }

            .mb-3 {
                margin-bottom: 0.5rem !important;
            }

            .btn {
                padding: 0.5rem !important;
            }
        }
    </style>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
